
{% extends "base.html" %}

{% block title %}Управление курсами{% endblock %}

{% block content %}
<!-- Desktop View -->
<div class="container-fluid mt-4 d-none d-lg-block">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="fw-bold text-primary">
                    <i class="fas fa-graduation-cap me-3"></i>
                    Управление курсами
                </h2>
                <div>
                    <a href="{{ url_for('unified_course_constructor') }}" class="btn btn-primary btn-lg shadow-sm">
                        <i class="fas fa-plus me-2"></i>
                        Создать курс
                    </a>
                </div>
            </div>

            <div class="card shadow-sm border-0">
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0">
                            <thead class="bg-primary text-white">
                                <tr>
                                    <th class="px-4 py-3">ID</th>
                                    <th class="px-4 py-3">Название</th>
                                    <th class="px-4 py-3">Описание</th>
                                    <th class="px-4 py-3">Статус</th>
                                    <th class="px-4 py-3">Создан</th>
                                    <th class="px-4 py-3">Действия</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for course in courses %}
                                <tr class="border-bottom">
                                    <td class="px-4 py-3">
                                        <span class="badge bg-light text-dark">{{ course.id }}</span>
                                    </td>
                                    <td class="px-4 py-3">
                                        <div class="fw-semibold text-primary">{{ course.title }}</div>
                                    </td>
                                    <td class="px-4 py-3">
                                        <span class="text-muted">{{ course.description|truncate(80) if course.description else 'Нет описания' }}</span>
                                    </td>
                                    <td class="px-4 py-3">
                                        {% if course.is_published %}
                                        <span class="badge bg-success fs-6 mb-2 d-block">
                                            <i class="fas fa-check-circle me-1"></i>
                                            Опубликован
                                        </span>
                                        <form method="POST" action="{{ url_for('unpublish_course', course_id=course.id) }}" style="display: inline;">
                                            <button type="submit" class="btn btn-sm btn-warning" onclick="return confirm('Скрыть курс от студентов? Сертификаты останутся активными.')">
                                                <i class="fas fa-eye-slash me-1"></i>
                                                Скрыть
                                            </button>
                                        </form>
                                        {% else %}
                                        <span class="badge bg-secondary fs-6 mb-2 d-block">
                                            <i class="fas fa-edit me-1"></i>
                                            Черновик
                                        </span>
                                        <form method="POST" action="{{ url_for('publish_course', course_id=course.id) }}" style="display: inline;">
                                            <button type="submit" class="btn btn-sm btn-success" onclick="return confirm('Опубликовать курс?')">
                                                <i class="fas fa-share me-1"></i>
                                                Опубликовать
                                            </button>
                                        </form>
                                        {% endif %}
                                    </td>
                                    <td class="px-4 py-3">
                                        <span class="text-muted">{{ course.created_at.strftime('%d.%m.%Y') }}</span>
                                    </td>
                                    <td class="px-4 py-3">
                                        <div class="btn-group-vertical gap-1">
                                            {% if course.is_published %}
                                            <a href="{{ url_for('view_course', course_id=course.id) }}" 
                                               class="btn btn-sm btn-info">
                                                <i class="fas fa-eye me-1"></i>
                                                Просмотр
                                            </a>
                                            {% endif %}
                                            <a href="{{ url_for('unified_course_constructor', course_id=course.id) }}" 
                                               class="btn btn-sm btn-primary">
                                                <i class="fas fa-edit me-1"></i>
                                                Редактировать
                                            </a>
                                            <button type="button" class="btn btn-sm btn-warning" 
                                                    onclick="resetAttempts({{ course.id }}, '{{ course.title }}')"
                                                    title="Сбросить все попытки экзаменов и тестов">
                                                <i class="fas fa-redo me-1"></i>
                                                Сбросить попытки
                                            </button>
                                            <button type="button" class="btn btn-sm btn-danger" 
                                                    onclick="deleteCourse({{ course.id }}, '{{ course.title }}')">
                                                <i class="fas fa-trash me-1"></i>
                                                Удалить
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Mobile & Tablet View -->
<div class="d-lg-none">
    <!-- Mobile Header with Gradient -->
    <div class="mobile-admin-header">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col">
                    <h1 class="mobile-admin-title">
                        <i class="fas fa-graduation-cap me-3"></i>
                        Управление курсами
                    </h1>
                    <p class="mobile-admin-subtitle mb-0">
                        Создавайте и управляйте образовательными курсами
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="mobile-actions-container">
        <div class="container-fluid">
            <div class="row g-3">
                <div class="col-12">
                    <a href="{{ url_for('unified_course_constructor') }}" class="btn btn-primary btn-lg w-100 mobile-action-btn">
                        <div class="d-flex align-items-center justify-content-center">
                            <i class="fas fa-plus fa-lg me-3"></i>
                            <div>
                                <div class="fw-bold">Создать новый курс</div>
                                <small class="opacity-75">Конструктор курсов</small>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Courses Grid -->
    <div class="mobile-courses-section">
        <div class="container-fluid">
            {% if courses %}
                <div class="row g-3">
                    {% for course in courses %}
                    <div class="col-12">
                        <div class="mobile-course-card">
                            <!-- Course Header -->
                            <div class="mobile-course-header">
                                <div class="d-flex align-items-start justify-content-between">
                                    <div class="flex-grow-1">
                                        <div class="mobile-course-id">
                                            <i class="fas fa-hashtag"></i>
                                            ID: {{ course.id }}
                                        </div>
                                        <h3 class="mobile-course-title">{{ course.title }}</h3>
                                        {% if course.description %}
                                        <p class="mobile-course-description">
                                            {{ course.description|truncate(100) }}
                                        </p>
                                        {% endif %}
                                    </div>
                                    <div class="mobile-course-status-badge">
                                        {% if course.is_published %}
                                        <span class="status-badge published">
                                            <i class="fas fa-check-circle"></i>
                                            <span>Опубликован</span>
                                        </span>
                                        {% else %}
                                        <span class="status-badge draft">
                                            <i class="fas fa-edit"></i>
                                            <span>Черновик</span>
                                        </span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>

                            <!-- Course Meta -->
                            <div class="mobile-course-meta">
                                <div class="meta-item">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span>Создан: {{ course.created_at.strftime('%d.%m.%Y') }}</span>
                                </div>
                            </div>

                            <!-- Course Actions -->
                            <div class="mobile-course-actions">
                                <!-- Primary Action -->
                                {% if course.is_published %}
                                <a href="{{ url_for('view_course', course_id=course.id) }}" 
                                   class="mobile-action-primary">
                                    <i class="fas fa-eye"></i>
                                    <span>Просмотреть курс</span>
                                    <i class="fas fa-chevron-right ms-auto"></i>
                                </a>
                                {% else %}
                                <a href="{{ url_for('unified_course_constructor', course_id=course.id) }}" 
                                   class="mobile-action-primary">
                                    <i class="fas fa-edit"></i>
                                    <span>Редактировать</span>
                                    <i class="fas fa-chevron-right ms-auto"></i>
                                </a>
                                {% endif %}

                                <!-- Secondary Actions -->
                                <div class="mobile-actions-grid">
                                    <!-- Edit Course -->
                                    <a href="{{ url_for('unified_course_constructor', course_id=course.id) }}" 
                                       class="mobile-action-secondary info flex-fill"
                                       style="text-decoration: none;">
                                        <i class="fas fa-edit"></i>
                                        <span>Редактировать</span>
                                    </a>

                                    <!-- Publish/Unpublish -->
                                    {% if course.is_published %}
                                    <form method="POST" action="{{ url_for('unpublish_course', course_id=course.id) }}" class="flex-fill">
                                        <button type="submit" class="mobile-action-secondary warning w-100" 
                                                onclick="return confirm('Скрыть курс? Сертификаты останутся активными.')">
                                            <i class="fas fa-eye-slash"></i>
                                            <span>Скрыть</span>
                                        </button>
                                    </form>
                                    {% else %}
                                    <form method="POST" action="{{ url_for('publish_course', course_id=course.id) }}" class="flex-fill">
                                        <button type="submit" class="mobile-action-secondary success w-100" 
                                                onclick="return confirm('Опубликовать курс?')">
                                            <i class="fas fa-share"></i>
                                            <span>Опубликовать</span>
                                        </button>
                                    </form>
                                    {% endif %}

                                    <!-- Reset Attempts -->
                                    <button type="button" class="mobile-action-secondary info flex-fill" 
                                            onclick="resetAttempts({{ course.id }}, '{{ course.title }}')"
                                            title="Сбросить все попытки">
                                        <i class="fas fa-redo"></i>
                                        <span>Сбросить</span>
                                    </button>

                                    <!-- Delete -->
                                    <button type="button" class="mobile-action-secondary danger flex-fill" 
                                            onclick="deleteCourse({{ course.id }}, '{{ course.title }}')">
                                        <i class="fas fa-trash"></i>
                                        <span>Удалить</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <!-- Empty State -->
                <div class="mobile-empty-state">
                    <div class="empty-state-content">
                        <div class="empty-state-icon">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <h3 class="empty-state-title">Курсы не найдены</h3>
                        <p class="empty-state-description">
                            Создайте первый курс, чтобы начать обучение студентов
                        </p>
                        <a href="{{ url_for('unified_course_constructor') }}" class="btn btn-primary btn-lg">
                            <i class="fas fa-plus me-2"></i>
                            Создать первый курс
                        </a>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
/* Mobile Admin Header */
.mobile-admin-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 2rem 0 1.5rem;
    margin: -1.5rem -15px 0;
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
    position: relative;
    overflow: hidden;
}

.mobile-admin-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%);
    animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
    0%, 100% { transform: translateX(-100%); }
    50% { transform: translateX(100%); }
}

.mobile-admin-title {
    font-size: 1.5rem;
    font-weight: 800;
    margin: 0;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    letter-spacing: -0.5px;
}

.mobile-admin-subtitle {
    font-size: 0.9rem;
    opacity: 0.9;
    margin-top: 0.5rem;
}

/* Actions Container */
.mobile-actions-container {
    padding: 1.5rem 0;
    background: linear-gradient(180deg, rgba(102, 126, 234, 0.05) 0%, rgba(255,255,255,1) 100%);
    margin: 0 -15px;
}

.mobile-action-btn {
    border-radius: 16px;
    padding: 1.25rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
    transform: translateY(0);
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
}

.mobile-action-btn:hover, .mobile-action-btn:active {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
}

/* Courses Section */
.mobile-courses-section {
    padding: 0 0 2rem;
    margin: 0 -15px;
    background: #f8fafc;
}

/* Course Cards */
.mobile-course-card {
    background: white;
    border-radius: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    overflow: hidden;
    border: 1px solid rgba(0,0,0,0.05);
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
}

.mobile-course-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #667eea, #764ba2);
}

.mobile-course-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0,0,0,0.15);
}

/* Course Header */
.mobile-course-header {
    padding: 1.5rem 1.5rem 1rem;
}

.mobile-course-id {
    font-size: 0.75rem;
    color: #6b7280;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.5rem;
}

.mobile-course-title {
    font-size: 1.2rem;
    font-weight: 700;
    color: #111827;
    margin: 0 0 0.75rem 0;
    line-height: 1.3;
}

.mobile-course-description {
    font-size: 0.9rem;
    color: #6b7280;
    line-height: 1.5;
    margin: 0;
}

/* Status Badge */
.mobile-course-status-badge {
    flex-shrink: 0;
    margin-left: 1rem;
}

.status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 50px;
    font-size: 0.8rem;
    font-weight: 600;
    white-space: nowrap;
    border: 2px solid;
}

.status-badge.published {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    border-color: rgba(255,255,255,0.3);
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
}

.status-badge.draft {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    border-color: rgba(255,255,255,0.3);
    box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
}

/* Course Meta */
.mobile-course-meta {
    padding: 0 1.5rem 1rem;
    border-bottom: 1px solid #f3f4f6;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    color: #6b7280;
}

.meta-item i {
    color: #9ca3af;
}

/* Course Actions */
.mobile-course-actions {
    padding: 1.5rem;
}

.mobile-action-primary {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.5rem;
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
    text-decoration: none;
    border-radius: 16px;
    font-weight: 600;
    margin-bottom: 1rem;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

.mobile-action-primary:hover, .mobile-action-primary:active {
    color: white;
    text-decoration: none;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
}

.mobile-actions-grid {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.mobile-action-secondary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.875rem;
    border: none;
    border-radius: 12px;
    font-size: 0.85rem;
    font-weight: 600;
    transition: all 0.3s ease;
    text-decoration: none;
    min-height: 50px;
}

.mobile-action-secondary.success {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
}

.mobile-action-secondary.warning {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
}

.mobile-action-secondary.info {
    background: linear-gradient(135deg, #06b6d4, #0891b2);
    color: white;
    box-shadow: 0 2px 8px rgba(6, 182, 212, 0.3);
}

.mobile-action-secondary.danger {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
}

.mobile-action-secondary:hover {
    transform: translateY(-1px);
    filter: brightness(1.1);
}

/* Empty State */
.mobile-empty-state {
    padding: 4rem 2rem;
    text-align: center;
}

.empty-state-content {
    max-width: 400px;
    margin: 0 auto;
}

.empty-state-icon {
    font-size: 5rem;
    color: #d1d5db;
    margin-bottom: 2rem;
    opacity: 0.7;
}

.empty-state-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #374151;
    margin-bottom: 1rem;
}

.empty-state-description {
    font-size: 1rem;
    color: #6b7280;
    line-height: 1.6;
    margin-bottom: 2rem;
}

/* Responsive Adjustments */
@media (max-width: 576px) {
    .mobile-admin-title {
        font-size: 1.3rem;
    }
    
    .mobile-course-card {
        border-radius: 16px;
    }
    
    .mobile-course-header {
        padding: 1.25rem;
    }
    
    .mobile-course-actions {
        padding: 1.25rem;
    }
    
    .mobile-actions-grid {
        flex-direction: column;
    }
    
    .mobile-action-secondary {
        width: 100%;
    }
    
    .status-badge {
        flex-direction: column;
        gap: 0.25rem;
        padding: 0.75rem;
    }
    
    .status-badge span {
        font-size: 0.7rem;
    }
}

/* Animation Enhancement */
@media (prefers-reduced-motion: no-preference) {
    .mobile-course-card {
        animation: fadeInUp 0.6s ease-out;
    }
    
    .mobile-course-card:nth-child(2) {
        animation-delay: 0.1s;
    }
    
    .mobile-course-card:nth-child(3) {
        animation-delay: 0.2s;
    }
    
    .mobile-course-card:nth-child(4) {
        animation-delay: 0.3s;
    }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
    .mobile-courses-section {
        background: #111827;
    }
    
    .mobile-course-card {
        background: #1f2937;
        border-color: #374151;
    }
    
    .mobile-course-title {
        color: #f9fafb;
    }
    
    .mobile-course-description {
        color: #d1d5db;
    }
    
    .mobile-course-id {
        color: #9ca3af;
    }
    
    .meta-item {
        color: #d1d5db;
    }
    
    .empty-state-title {
        color: #f9fafb;
    }
    
    .empty-state-description {
        color: #d1d5db;
    }
}
</style>

<script>
function deleteCourse(courseId, courseTitle) {
    // Enhanced confirmation with better UX
    const modal = document.createElement('div');
    modal.innerHTML = `
        <div class="modal fade" id="deleteModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-danger text-white border-0">
                        <h5 class="modal-title">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            Подтверждение удаления
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <div class="text-center mb-3">
                            <i class="fas fa-trash-alt fa-3x text-danger mb-3"></i>
                            <h6 class="fw-bold">Вы уверены, что хотите удалить курс?</h6>
                            <p class="text-muted mb-0">"${courseTitle}"</p>
                        </div>
                        <div class="alert alert-warning border-0">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Внимание!</strong> Это действие нельзя отменить. Все данные курса будут потеряны навсегда.
                        </div>
                    </div>
                    <div class="modal-footer border-0 justify-content-center">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-2"></i>
                            Отмена
                        </button>
                        <button type="button" class="btn btn-danger" id="confirmDelete">
                            <i class="fas fa-trash me-2"></i>
                            Удалить курс
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    const modalInstance = new bootstrap.Modal(document.getElementById('deleteModal'));
    modalInstance.show();
    
    document.getElementById('confirmDelete').addEventListener('click', function() {
        // Show loading state
        this.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Удаление...';
        this.disabled = true;
        
        fetch(`/admin/course/${courseId}/delete`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Success animation
                modalInstance.hide();
                showToast('Курс успешно удален', 'success');
                setTimeout(() => location.reload(), 1000);
            } else {
                showToast('Ошибка при удалении курса: ' + data.error, 'error');
            }
        })
        .catch(error => {
            showToast('Произошла ошибка: ' + error, 'error');
        })
        .finally(() => {
            modal.remove();
        });
    });
}

function resetAttempts(courseId, courseTitle) {
    // Enhanced confirmation for reset attempts
    const modal = document.createElement('div');
    modal.innerHTML = `
        <div class="modal fade" id="resetModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-warning text-dark border-0">
                        <h5 class="modal-title">
                            <i class="fas fa-redo me-2"></i>
                            Сброс попыток
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <div class="text-center mb-3">
                            <i class="fas fa-redo-alt fa-3x text-warning mb-3"></i>
                            <h6 class="fw-bold">Сбросить все попытки экзаменов и тестов?</h6>
                            <p class="text-muted mb-0">"${courseTitle}"</p>
                        </div>
                        <div class="alert alert-info border-0">
                            <i class="fas fa-info-circle me-2"></i>
                            Это позволит студентам заново пройти все экзамены и тесты в курсе.
                        </div>
                    </div>
                    <div class="modal-footer border-0 justify-content-center">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-2"></i>
                            Отмена
                        </button>
                        <button type="button" class="btn btn-warning" id="confirmReset">
                            <i class="fas fa-redo me-2"></i>
                            Сбросить попытки
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    const modalInstance = new bootstrap.Modal(document.getElementById('resetModal'));
    modalInstance.show();
    
    document.getElementById('confirmReset').addEventListener('click', function() {
        // Show loading state
        this.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Сброс...';
        this.disabled = true;
        
        fetch(`/admin/course/${courseId}/reset-attempts`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                modalInstance.hide();
                showToast(data.message, 'success');
                setTimeout(() => location.reload(), 1000);
            } else {
                showToast('Ошибка при сбросе попыток: ' + data.error, 'error');
            }
        })
        .catch(error => {
            showToast('Произошла ошибка: ' + error, 'error');
        })
        .finally(() => {
            modal.remove();
        });
    });
}

// Enhanced toast notifications
function showToast(message, type = 'info') {
    const toastContainer = document.getElementById('toastContainer') || createToastContainer();
    
    const toastEl = document.createElement('div');
    toastEl.className = `toast align-items-center text-white bg-${type === 'error' ? 'danger' : type} border-0 shadow-lg`;
    toastEl.setAttribute('role', 'alert');
    toastEl.innerHTML = `
        <div class="d-flex">
            <div class="toast-body">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} me-2"></i>
                ${message}
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
        </div>
    `;
    
    toastContainer.appendChild(toastEl);
    const toast = new bootstrap.Toast(toastEl, { delay: 5000 });
    toast.show();
    
    toastEl.addEventListener('hidden.bs.toast', () => {
        toastEl.remove();
    });
}

function createToastContainer() {
    const container = document.createElement('div');
    container.id = 'toastContainer';
    container.className = 'toast-container position-fixed top-0 end-0 p-3';
    container.style.zIndex = '9999';
    document.body.appendChild(container);
    return container;
}

// Enhanced animations on page load
document.addEventListener('DOMContentLoaded', function() {
    // Animate course cards on mobile
    if (window.innerWidth < 992) {
        const cards = document.querySelectorAll('.mobile-course-card');
        cards.forEach((card, index) => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(30px)';
            
            setTimeout(() => {
                card.style.transition = 'all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 100);
        });
    }
    
    // Add ripple effect to buttons
    document.querySelectorAll('.mobile-action-btn, .mobile-action-primary, .mobile-action-secondary').forEach(button => {
        button.addEventListener('click', function(e) {
            const ripple = document.createElement('span');
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.cssText = `
                position: absolute;
                width: ${size}px;
                height: ${size}px;
                left: ${x}px;
                top: ${y}px;
                background: rgba(255,255,255,0.3);
                border-radius: 50%;
                transform: scale(0);
                animation: ripple 0.6s ease-out;
                pointer-events: none;
            `;
            
            this.style.position = 'relative';
            this.style.overflow = 'hidden';
            this.appendChild(ripple);
            
            setTimeout(() => ripple.remove(), 600);
        });
    });
});

// CSS for ripple animation
const style = document.createElement('style');
style.textContent = `
    @keyframes ripple {
        to {
            transform: scale(2);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}
